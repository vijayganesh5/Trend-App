import{j as e,a as k,r as o,S as D,O as I,e as R,B as d}from"./index-BjbOuBLy.js";import{T}from"./Title-D4NmpLxE.js";import{C as F}from"./CartTotal-4jDB2azO.js";const L=({message:u="Order Placed Successfully!",subMessage:x="Thank you for your purchase.",onClose:y})=>e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-lg text-center w-[90%] max-w-sm",children:[e.jsx("img",{src:k.quality_icon,alt:"Success",className:"mx-auto w-12 h-12 mb-4"}),e.jsx("h2",{className:"text-xl font-semibold text-green-600 mb-2",children:u}),e.jsx("p",{className:"text-gray-600 mb-6",children:x}),e.jsx("button",{onClick:y,className:"bg-black text-white px-6 py-2 rounded hover:bg-gray-800 transition",children:"OK"})]})}),q=()=>{const{navigate:u,cartItems:x,resetContextData:y}=o.useContext(D),{placeOrder:v}=o.useContext(I),{getUserProfile:f}=R(),[p,h]=o.useState({name:"",email:"",mobile:""}),[n,b]=o.useState({street:"",city:"",state:"",zip:"",country:"",mobile:""}),[N,g]=o.useState(!1),[w,m]=o.useState(!1);o.useEffect(()=>{(async()=>{m(!0);try{const{name:a,email:l,mobile:s,shippingAddress:t}=await f();h({name:a||"",email:l||"",mobile:s||""}),b({street:(t==null?void 0:t.street)||"",city:(t==null?void 0:t.city)||"",state:(t==null?void 0:t.state)||"",zip:(t==null?void 0:t.zip)||"",country:(t==null?void 0:t.country)||"",mobile:(t==null?void 0:t.mobile)||""})}catch(a){d.error(a.message||"Failed to fetch user profile.")}finally{m(!1)}})()},[f]);const c=r=>{const{name:a,value:l}=r.target;b(s=>({...s,[a]:l}))},C=r=>{const{name:a,value:l}=r.target;h(s=>({...s,[a]:l}))},S=async()=>{const{city:r,zip:a,country:l,street:s,state:t}=n,{name:E,email:O,mobile:j}=p,z=i=>/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(i.trim()),M=i=>/^[0-9]{7,15}$/.test(i.trim());if(!t||!r||!a||!l||!j||!s){d.error("Please fill in all shipping address fields.");return}if(!z(O)){d.error("Please enter a valid email address.");return}if(!M(j)){d.error("Please enter a valid mobile number (7â€“15 digits).");return}m(!0);try{await v({street:`${E} ${r}`,city:r,zip:a,country:l,state:t},x,y),g(!0)}catch(i){console.error("Error placing order:",i),d.error("Failed to place order. Please try again.")}finally{m(!1)}},P=()=>{g(!1),u("/orders")};return w?e.jsx("div",{className:"flex items-center justify-center min-h-[80vh]",children:e.jsx("p",{className:"text-lg font-semibold",children:"Loading..."})}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex flex-col justify-evenly gap-4 pt-5 sm:flex-row sm:pt-14 min-h-[80vh] border-t",children:[e.jsxs("div",{className:"flex flex-col w-full gap-4 sm:max-w-[480px]",children:[e.jsx("div",{className:"my-3 text-xl sm:text-2xl",children:e.jsx(T,{text1:"DELIVERY",text2:"INFORMATION"})}),e.jsx("input",{className:"w-full px-4 py-2 border border-gray-300 rounded disabled:bg-gray-100 cursor-not-allowed",type:"email",name:"email",placeholder:"Email Address",value:p.email,onChange:C,disabled:!0}),e.jsx("input",{className:"w-full px-4 py-2 border border-gray-300 rounded",type:"text",name:"street",placeholder:"Street",value:n.street,onChange:c}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("input",{className:"w-full px-4 py-2 border border-gray-300 rounded",type:"text",name:"city",placeholder:"City",value:n.city,onChange:c}),e.jsx("input",{className:"w-full px-4 py-2 border border-gray-300 rounded",type:"text",name:"state",placeholder:"State",value:n.state,onChange:c})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("input",{className:"w-full px-4 py-2 border border-gray-300 rounded",type:"text",name:"zip",placeholder:"Zip Code",value:n.zip,onChange:c}),e.jsx("input",{className:"w-full px-4 py-2 border border-gray-300 rounded",type:"text",name:"country",placeholder:"Country",value:n.country,onChange:c})]}),e.jsx("input",{className:"w-full px-4 py-2 border border-gray-300 rounded",type:"tel",name:"mobile",placeholder:"Mobile",value:p.mobile,onChange:c})]}),e.jsxs("div",{className:"mt-8",children:[e.jsx("div",{className:"mt-8 min-w-80",children:e.jsx(F,{})}),e.jsx("div",{className:"w-full mt-8 text-end",children:e.jsx("button",{onClick:S,className:"px-16 py-3 text-sm text-white bg-black active:bg-gray-800",children:"PLACE ORDER"})})]})]}),N&&e.jsx(L,{onClose:P})]})};export{q as default};
